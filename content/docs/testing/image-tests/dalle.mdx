---
title: DALL-E Tests
description: 3 tests for OpenAI DALL-E image generation
---

# DALL-E Tests

DALL-E tests verify that the Layers API correctly handles OpenAI's DALL-E 3 image generation model.

## Test Summary

| Test | Model | Description |
|------|-------|-------------|
| Basic Generation | dall-e-3 | Generate image from prompt |
| HD Quality | dall-e-3 | High-definition output |
| Custom Size | dall-e-3 | Non-square dimensions |

## Running Tests

```bash
cd packages/@layers/models
LAYERS_API_URL=https://layers.hustletogether.com \
LAYERS_API_KEY=lyr_live_xxx \
bun test image-generation -t "DALL-E"
```

## Test Implementation

### Basic Generation Test

```typescript
it('should generate image with DALL-E 3', async () => {
  const response = await fetch(`${LAYERS_API_URL}/api/v1/images/generate`, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${LAYERS_API_KEY}`,
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      model: 'openai/dall-e-3',
      prompt: 'A serene mountain landscape at sunset with a calm lake',
      size: '1024x1024',
      quality: 'standard',
      n: 1,
    }),
  });

  expect(response.status).toBe(200);
  const data = await response.json();

  expect(data.data).toBeDefined();
  expect(data.data.length).toBe(1);
  expect(data.data[0].url).toBeTruthy();
}, 60000); // 60s timeout for image generation
```

### HD Quality Test

```typescript
it('should generate HD quality image', async () => {
  const response = await fetch(`${LAYERS_API_URL}/api/v1/images/generate`, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${LAYERS_API_KEY}`,
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      model: 'openai/dall-e-3',
      prompt: 'A detailed macro photograph of a butterfly wing',
      size: '1024x1024',
      quality: 'hd',
      n: 1,
    }),
  });

  expect(response.status).toBe(200);
  const data = await response.json();
  expect(data.data[0].url).toBeTruthy();
}, 60000);
```

### Custom Size Test

```typescript
it('should generate landscape image', async () => {
  const response = await fetch(`${LAYERS_API_URL}/api/v1/images/generate`, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${LAYERS_API_KEY}`,
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      model: 'openai/dall-e-3',
      prompt: 'A panoramic view of a city skyline',
      size: '1792x1024', // Landscape
      quality: 'standard',
      n: 1,
    }),
  });

  expect(response.status).toBe(200);
  const data = await response.json();
  expect(data.data[0].url).toBeTruthy();
}, 60000);
```

## Request Format

```json
{
  "model": "openai/dall-e-3",
  "prompt": "A serene mountain landscape at sunset",
  "size": "1024x1024",
  "quality": "standard",
  "n": 1,
  "style": "vivid"
}
```

## Parameters

| Parameter | Type | Options | Default |
|-----------|------|---------|---------|
| `model` | string | `openai/dall-e-3`, `openai/dall-e-2` | Required |
| `prompt` | string | Max 4000 chars | Required |
| `size` | string | See below | `1024x1024` |
| `quality` | string | `standard`, `hd` | `standard` |
| `n` | number | 1 (DALL-E 3), 1-10 (DALL-E 2) | 1 |
| `style` | string | `vivid`, `natural` | `vivid` |

## Supported Sizes

### DALL-E 3
| Size | Aspect Ratio | Use Case |
|------|--------------|----------|
| `1024x1024` | 1:1 (Square) | Profile images, icons |
| `1792x1024` | 16:9 (Landscape) | Banners, headers |
| `1024x1792` | 9:16 (Portrait) | Mobile, stories |

### DALL-E 2
| Size | Description |
|------|-------------|
| `256x256` | Small, fast |
| `512x512` | Medium |
| `1024x1024` | Large |

## Response Format

```json
{
  "created": 1705612800,
  "data": [
    {
      "url": "https://oaidalleapiprodscus.blob.core.windows.net/...",
      "revised_prompt": "A breathtaking serene mountain landscape at golden hour sunset, featuring a perfectly still crystal-clear lake reflecting the majestic snow-capped peaks..."
    }
  ]
}
```

## Revised Prompts

DALL-E 3 automatically enhances prompts for better results:

```typescript
const response = await generateImage({
  prompt: 'A cat',  // Simple prompt
});

console.log(response.data[0].revised_prompt);
// "A fluffy orange tabby cat sitting gracefully on a sunlit
//  windowsill, soft bokeh background, professional photography..."
```

## Style Options

| Style | Description |
|-------|-------------|
| `vivid` | Hyper-real, dramatic, cinematic |
| `natural` | More realistic, less stylized |

```json
{
  "model": "openai/dall-e-3",
  "prompt": "A forest path",
  "style": "natural"
}
```

## Usage Example

```typescript
async function generateImage(prompt: string) {
  const response = await fetch('https://api.layers.dev/v1/images/generate', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer lyr_live_xxx',
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      model: 'openai/dall-e-3',
      prompt,
      size: '1024x1024',
      quality: 'standard',
      style: 'vivid',
    }),
  });

  const data = await response.json();
  return data.data[0].url;
}

const imageUrl = await generateImage('A futuristic city at night');
console.log('Generated image:', imageUrl);
```

## Cost

| Model | Quality | Price |
|-------|---------|-------|
| dall-e-3 | standard | $0.040 |
| dall-e-3 | hd | $0.080 |
| dall-e-2 | - | $0.020 |

## Content Policy

DALL-E enforces content policies. Avoid:
- Violence or gore
- Adult content
- Real people's likenesses
- Copyrighted characters
- Harmful or deceptive content

```json
// Error response for policy violation
{
  "error": {
    "code": "content_policy_violation",
    "message": "Your request was rejected as a result of our safety system."
  }
}
```

## Best Practices

1. **Be descriptive** - Detailed prompts yield better results
2. **Specify style** - Include art style, lighting, mood
3. **Use HD sparingly** - Only when detail matters
4. **Cache URLs** - URLs expire after ~1 hour
5. **Handle timeouts** - Generation takes 10-30 seconds
