---
title: Authentication
description: API key management, security best practices, and authentication flows
---

# Authentication

All Layers API requests require authentication using an API key. This guide covers how to get, use, and manage your API keys securely.

## API Key Format

Layers API keys follow a specific format for easy identification:

```
lyr_live_sk_1a2b3c4d5e6f7890...
```

| Prefix | Environment | Billing |
|--------|-------------|---------|
| `lyr_live_` | Production | Deducts credits |
| `lyr_test_` | Testing | Limited, no billing |

**Key Properties:**
- 40+ characters total
- Cryptographically random
- Hashed before storage (we can't see your full key)

---

## Using Your API Key

### HTTP Headers

Include your API key in the `Authorization` header:

```
Authorization: Bearer lyr_live_sk_1a2b3c4d5e6f7890...
```

### Request Examples

#### cURL

```bash
curl -X POST https://preview.hustletogether.com/api/v1/chat \
  -H "Authorization: Bearer lyr_live_sk_xxxxx" \
  -H "Content-Type: application/json" \
  -d '{"model": "anthropic/claude-sonnet-4.5", "messages": [{"role": "user", "content": "Hello"}]}'
```

#### TypeScript

```typescript
const response = await fetch('https://preview.hustletogether.com/api/v1/chat', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${process.env.LAYERS_API_KEY}`,
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    model: 'anthropic/claude-sonnet-4.5',
    messages: [{ role: 'user', content: 'Hello' }],
  }),
});
```

#### Python

```python
import os
import requests

response = requests.post(
    'https://preview.hustletogether.com/api/v1/chat',
    headers={
        'Authorization': f'Bearer {os.environ["LAYERS_API_KEY"]}',
        'Content-Type': 'application/json',
    },
    json={
        'model': 'anthropic/claude-sonnet-4.5',
        'messages': [{'role': 'user', 'content': 'Hello'}],
    }
)
```

---

## Security Best Practices

### Environment Variables

Never hardcode API keys in your source code:

```typescript
// BAD - Never do this
const apiKey = 'lyr_live_sk_1a2b3c4d5e6f7890...';

// GOOD - Use environment variables
const apiKey = process.env.LAYERS_API_KEY;
```

### .gitignore

Always exclude environment files:

```gitignore
# .gitignore
.env
.env.local
.env.*.local
```

### Server-Side Only

API keys should only be used server-side:

```typescript
// GOOD - Server-side (API route, server action)
// app/api/chat/route.ts
export async function POST(request: Request) {
  const response = await fetch('https://preview.hustletogether.com/api/v1/chat', {
    headers: {
      'Authorization': `Bearer ${process.env.LAYERS_API_KEY}`,
    },
    // ...
  });
}

// BAD - Client-side (exposed to users)
// components/Chat.tsx
const apiKey = process.env.NEXT_PUBLIC_LAYERS_API_KEY; // NEVER DO THIS
```

### Key Rotation

If you suspect a key is compromised:

1. Generate a new key immediately
2. Update all deployments with the new key
3. Revoke the old key
4. Review usage logs for suspicious activity

---

## Authentication Errors

### Missing Authorization Header (401)

```json
{
  "error": "Missing or invalid Authorization header. Use: Bearer lyr_live_xxxxx"
}
```

**Fix:** Add the `Authorization` header with your API key.

### Invalid Key Format (401)

```json
{
  "error": "Invalid API key format. Keys must start with lyr_live_"
}
```

**Fix:** Ensure your key starts with `lyr_live_` or `lyr_test_`.

### Invalid or Revoked Key (401)

```json
{
  "error": "Invalid API key"
}
```

**Fix:** Check that your key is correct and hasn't been revoked.

### Deactivated Key (401)

```json
{
  "error": "API key is deactivated"
}
```

**Fix:** Reactivate the key in your dashboard or generate a new one.

### Expired Key (401)

```json
{
  "error": "API key has expired"
}
```

**Fix:** Generate a new key. Keys can be set to expire for security.

---

## Rate Limiting

Rate limits are applied per API key based on your subscription tier:

| Tier | Requests/Minute |
|------|-----------------|
| **Free** | 10 |
| **Starter** | 60 |
| **Pro** | 300 |
| **Team** | 1,000 |

### Rate Limit Headers

Every response includes rate limit information:

```
X-RateLimit-Limit: 60
X-RateLimit-Remaining: 58
X-RateLimit-Reset: 1705402860
```

| Header | Description |
|--------|-------------|
| `X-RateLimit-Limit` | Maximum requests per minute |
| `X-RateLimit-Remaining` | Remaining requests in current window |
| `X-RateLimit-Reset` | Unix timestamp when the window resets |

### Rate Limit Exceeded (429)

```json
{
  "error": "Rate limit exceeded",
  "limit": 10,
  "reset_at": "2026-01-16T12:01:00.000Z"
}
```

**Handling rate limits:**

```typescript
async function callWithRetry(request: () => Promise<Response>, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    const response = await request();

    if (response.status === 429) {
      const resetAt = response.headers.get('X-RateLimit-Reset');
      const waitMs = resetAt
        ? (parseInt(resetAt) * 1000) - Date.now()
        : 60000;

      console.log(`Rate limited. Waiting ${waitMs}ms...`);
      await new Promise(resolve => setTimeout(resolve, waitMs));
      continue;
    }

    return response;
  }

  throw new Error('Max retries exceeded');
}
```

---

## Demo Mode

During development, if Supabase is not configured, the API runs in **demo mode**:

- Any key starting with `lyr_live_` is accepted
- Credits are not deducted
- Usage is not logged
- Rate limits still apply (demo tier)

This allows testing the API without a full Supabase setup.

**To disable demo mode:** Configure Supabase environment variables.

---

## Managing API Keys

### Creating Keys

> **Coming Soon:** Dashboard for key management

Currently, API keys are provisioned manually during beta.

### Key Metadata

Each key tracks:
- `created_at` - When the key was generated
- `last_used_at` - Last API request timestamp
- `is_active` - Whether the key is currently active
- `expires_at` - Optional expiration date

### Revoking Keys

To revoke a key:
1. Log into your dashboard
2. Navigate to API Keys
3. Click "Revoke" on the key you want to disable

Revoked keys return a 401 error immediately.

---

## Multiple Keys

You can create multiple API keys for different purposes:

| Use Case | Recommendation |
|----------|----------------|
| Development | Use `lyr_test_` keys |
| Staging | Separate `lyr_live_` key with low limits |
| Production | Primary `lyr_live_` key |
| CI/CD | Dedicated key for automated tests |

This allows you to:
- Track usage by environment
- Revoke compromised keys without affecting others
- Set different rate limits per key (coming soon)

---

## OpenAI SDK Compatibility

If using the OpenAI SDK, configure it to use Layers:

```typescript
import OpenAI from 'openai';

const client = new OpenAI({
  baseURL: 'https://preview.hustletogether.com/api/v1',
  apiKey: process.env.LAYERS_API_KEY,  // Your Layers key
});

// Now use any Layers model
const response = await client.chat.completions.create({
  model: 'anthropic/claude-sonnet-4.5',
  messages: [{ role: 'user', content: 'Hello!' }],
});
```

---

## Next Steps

- [Getting Started](/docs/getting-started) - Quick setup guide
- [API Reference](/docs/api/reference) - Full endpoint documentation
- [Rate Limiting](/docs/api/reference#rate-limits) - Detailed rate limit info
- [Credit System](/docs/credits) - Understand billing
