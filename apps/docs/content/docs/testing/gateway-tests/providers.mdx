---
title: Provider Connectivity Tests
description: 5 tests verifying connectivity to all AI providers
---

# Provider Connectivity Tests

These tests verify that each AI provider is reachable through the Vercel AI Gateway and can generate basic text responses.

## Test Summary

| Provider | Model Tested | Test |
|----------|--------------|------|
| Anthropic | claude-haiku-4.5 | Basic text generation |
| OpenAI | gpt-4o-mini | Basic text generation |
| Google | gemini-2.5-flash-lite | Basic text generation |
| Perplexity | sonar | Basic text generation |
| Morph | morph-v3-fast | Basic text generation |

## Running Tests

```bash
cd packages/@layers/models
AI_GATEWAY_API_KEY=vck_xxx bun test gateway -t "Provider"
```

## Test Implementation

### Anthropic Test

```typescript
it('should generate text with Anthropic', async () => {
  const { text } = await generateText({
    model: gateway('anthropic/claude-haiku-4.5'),
    prompt: 'Say hello in one word.',
    maxTokens: 10,
  });

  expect(text).toBeTruthy();
  expect(text.toLowerCase()).toContain('hello');
});
```

### OpenAI Test

```typescript
it('should generate text with OpenAI', async () => {
  const { text } = await generateText({
    model: gateway('openai/gpt-4o-mini'),
    prompt: 'Say hello in one word.',
    maxTokens: 10,
  });

  expect(text).toBeTruthy();
});
```

### Google Test

```typescript
it('should generate text with Google', async () => {
  const { text } = await generateText({
    model: gateway('google/gemini-2.5-flash-lite'),
    prompt: 'Say hello in one word.',
    maxTokens: 10,
  });

  expect(text).toBeTruthy();
});
```

### Perplexity Test

```typescript
it('should generate text with Perplexity', async () => {
  const { text } = await generateText({
    model: gateway('perplexity/sonar'),
    prompt: 'Say hello in one word.',
    maxTokens: 10,
  });

  expect(text).toBeTruthy();
});
```

### Morph Test

```typescript
it('should generate text with Morph', async () => {
  const { text } = await generateText({
    model: gateway('morph/morph-v3-fast'),
    prompt: 'Say hello in one word.',
    maxTokens: 10,
  });

  expect(text).toBeTruthy();
});
```

## Expected Results

All providers should return:

- Non-empty text response
- Response within 10 seconds (for fast models)
- No authentication errors

## Troubleshooting

### "AI Gateway request failed"

- Verify `AI_GATEWAY_API_KEY` is set correctly
- Check if the provider has rate limits
- Try a different model from the same provider

### Timeout Errors

- Increase test timeout: `}, 30000);`
- Some providers (Perplexity with search) are slower

### Model Not Found

- Verify model ID format: `provider/model-name`
- Check if model is available in AI Gateway
